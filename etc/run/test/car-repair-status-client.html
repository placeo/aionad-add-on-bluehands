<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°¨ëŸ‰ ìˆ˜ë¦¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #4a90e2;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .server-config {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }

        .config-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .config-row label {
            font-weight: bold;
            min-width: 100px;
        }

        .config-row input, .config-row select {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .main-content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            background: #f8f9fa;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
        }

        .response-area {
            margin-top: 20px;
            padding: 20px;
            background: #1e1e1e;
            color: #00ff00;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .car-list {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .car-item {
            background: white;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .car-item:hover {
            transform: translateY(-5px);
        }

        .car-item h3 {
            color: #4CAF50;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .car-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-in-progress {
            background: #ffeaa7;
            color: #2d3436;
        }

        .status-completed {
            background: #00b894;
            color: white;
        }

        .status-final-inspection {
            background: #fdcb6e;
            color: #2d3436;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .loading {
            display: none;
            text-align: center;
            color: #6c757d;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .car-list {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .config-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .config-row label {
                min-width: auto;
                margin-bottom: 5px;
            }
        }

        @media (max-width: 1200px) {
            .car-list {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš— ì°¨ëŸ‰ ìˆ˜ë¦¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            <p>ì‹¤ì‹œê°„ ì°¨ëŸ‰ ìˆ˜ë¦¬ í˜„í™© ê´€ë¦¬ ì›¹ í´ë¼ì´ì–¸íŠ¸</p>
        </div>

        <div class="server-config">
            <div class="config-row">
                <label>ì„œë²„ IP:</label>
                <select id="serverIpSelect" onchange="handleIpSelection()">
                    <option value="172.23.249.90">172.23.249.90</option>
                    <option value="192.168.10.9">192.168.10.9</option>
                    <option value="custom">ì§ì ‘ ì…ë ¥</option>
                </select>
                <input type="text" id="serverIp" value="172.23.249.90" placeholder="ì„œë²„ IP ì£¼ì†Œ (ESC í‚¤ë¡œ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ëŒì•„ê°€ê¸°)" style="display: none;" onkeydown="handleIpInputKeydown(event)">
            </div>
            <div class="config-row">
                <label>í¬íŠ¸:</label>
                <input type="number" id="serverPort" value="8080" placeholder="í¬íŠ¸ ë²ˆí˜¸">
            </div>
        </div>

        <div class="main-content">
            <!-- ì „ì²´ ëª©ë¡ ì¡°íšŒ ì„¹ì…˜ -->
            <div class="section">
                <h2>ğŸ“‹ ì „ì²´ ì°¨ëŸ‰ ëª©ë¡ ì¡°íšŒ</h2>
                <div class="quick-actions">
                    <button class="btn btn-info" onclick="getAllCarRepairInfo()">ì „ì²´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨</button>
                    <button class="btn btn-secondary" onclick="clearResponse()">í™”ë©´ ì§€ìš°ê¸°</button>
                </div>
                <div class="loading" id="loadingAll">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                <div class="car-list" id="carList"></div>
            </div>

            <!-- ì°¨ëŸ‰ ì •ë³´ ì¶”ê°€ ì„¹ì…˜ -->
            <div class="section">
                <h2>â• ìƒˆ ì°¨ëŸ‰ ìˆ˜ë¦¬ ì •ë³´ ì¶”ê°€</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ì°¨ëŸ‰ ë²ˆí˜¸</label>
                        <input type="text" id="addPlateNumber" readonly style="background-color: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label>ì°¨ëŸ‰ ëª¨ë¸</label>
                        <input type="text" id="addCarModel" readonly style="background-color: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label>ìˆ˜ë¦¬ ìƒíƒœ</label>
                        <select id="addRepairStatus" onchange="updateFinishTimeField()">
                            <option value="IN_PROGRESS">ì‘ì—…ì¤‘</option>
                            <option value="FINAL_INSPECTION">ìµœì¢…ì ê²€</option>
                            <option value="COMPLETED">ì‘ì—…ì™„ë£Œ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ì™„ë£Œ ì˜ˆì • ì‹œê°„</label>
                        <input type="time" id="addFinishTime" readonly style="background-color: #f8f9fa;">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="addCarRepairInfo()">ì°¨ëŸ‰ ì •ë³´ ì¶”ê°€</button>
                
                <!-- ì¶”ê°€ ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
                <div id="addResultArea" style="margin-top: 15px; padding: 10px; border-radius: 8px; display: none;">
                    <strong>ì¶”ê°€ ê²°ê³¼:</strong>
                    <div id="addResultMessage" style="margin-top: 5px;"></div>
                </div>
            </div>

            <!-- íŠ¹ì • ì°¨ëŸ‰ ì¡°íšŒ ì„¹ì…˜ -->
            <div class="section">
                <h2>ğŸ” íŠ¹ì • ì°¨ëŸ‰ ì¡°íšŒ</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ì°¨ëŸ‰ ë²ˆí˜¸</label>
                        <input type="text" id="searchPlateNumber" placeholder="ì¡°íšŒí•  ì°¨ëŸ‰ ë²ˆí˜¸">
                    </div>
                </div>
                <button class="btn btn-info" onclick="getCarRepairInfo()">ì°¨ëŸ‰ ì¡°íšŒ</button>
            </div>

            <!-- ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì • ì„¹ì…˜ -->
            <div class="section">
                <h2>âœï¸ ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì •</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ì°¨ëŸ‰ ë²ˆí˜¸</label>
                        <input type="text" id="updatePlateNumber" placeholder="ìˆ˜ì •í•  ì°¨ëŸ‰ ë²ˆí˜¸">
                    </div>
                    <div class="form-group">
                        <label>ì°¨ëŸ‰ ëª¨ë¸</label>
                        <input type="text" id="updateCarModel" placeholder="ìƒˆ ì°¨ëŸ‰ ëª¨ë¸">
                    </div>
                    <div class="form-group">
                        <label>ìˆ˜ë¦¬ ìƒíƒœ</label>
                        <select id="updateRepairStatus">
                            <option value="IN_PROGRESS">ì‘ì—…ì¤‘</option>
                            <option value="FINAL_INSPECTION">ìµœì¢…ì ê²€</option>
                            <option value="COMPLETED">ì‘ì—…ì™„ë£Œ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ì™„ë£Œ ì˜ˆì • ì‹œê°„</label>
                        <input type="time" id="updateFinishTime">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="updateCarRepairInfo()">ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì •</button>
            </div>

            <!-- ì°¨ëŸ‰ ì •ë³´ ì‚­ì œ ì„¹ì…˜ -->
            <div class="section">
                <h2>ğŸ—‘ï¸ ì°¨ëŸ‰ ì •ë³´ ì‚­ì œ</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ì°¨ëŸ‰ ë²ˆí˜¸</label>
                        <input type="text" id="deletePlateNumber" placeholder="ì‚­ì œí•  ì°¨ëŸ‰ ë²ˆí˜¸">
                    </div>
                </div>
                <button class="btn btn-danger" onclick="deleteCarRepairInfo()">ì°¨ëŸ‰ ì •ë³´ ì‚­ì œ</button>
            </div>

            <!-- í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¶”ê°€ ì„¹ì…˜ -->
            <div class="section">
                <h2>ğŸ§ª í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¼ê´„ ì¶”ê°€</h2>
                <p>http-server.shì™€ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì¼ê´„ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
                <div class="quick-actions">
                    <button class="btn btn-primary" onclick="addTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¶”ê°€</button>
                    <button class="btn btn-secondary" onclick="testQueries()">í…ŒìŠ¤íŠ¸ ì¡°íšŒ ì‹¤í–‰</button>
                    <button class="btn btn-primary" onclick="testUpdates()">í…ŒìŠ¤íŠ¸ ìˆ˜ì • ì‹¤í–‰</button>
                    <button class="btn btn-danger" onclick="testDeletes()">í…ŒìŠ¤íŠ¸ ì‚­ì œ ì‹¤í–‰</button>
                </div>
            </div>

            <!-- ì‘ë‹µ ë¡œê·¸ ì„¹ì…˜ -->
            <div class="section">
                <h2>ğŸ“‹ API ì‘ë‹µ ë¡œê·¸</h2>
                <div class="response-area" id="responseArea">ì—¬ê¸°ì— API ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤...</div>
            </div>
        </div>
    </div>

    <script>
        // ì°¨ëŸ‰ ë²ˆí˜¸ ìë™ ì¦ê°€ ë³€ìˆ˜
        let currentCarNumber = 100;

        // ì°¨ëŸ‰ ëª¨ë¸ ëª©ë¡
        const carModels = [
            'ì†Œë‚˜íƒ€', 'ê·¸ëœì €', 'ì•„ë°˜ë–¼', 'ì—˜ë€íŠ¸ë¼', 'íˆ¬ì‹¼', 'ì‹¼íƒ€í˜', 'íŒ°ë¦¬ì„¸ì´ë“œ',
            'ìº ë¦¬', 'ì•„ì½”ë“œ', 'K5', 'K7', 'K9', 'ìŠ¤í¬í‹°ì§€', 'ì…€í† ìŠ¤', 'ì˜ë Œí† ',
            'BMW 520d', 'BMW X3', 'BMW X5', 'ë²¤ì¸  Eí´ë˜ìŠ¤', 'ë²¤ì¸  Cí´ë˜ìŠ¤',
            'ì•„ìš°ë”” A4', 'ì•„ìš°ë”” Q5', 'ë ‰ì„œìŠ¤ ES', 'ì œë„¤ì‹œìŠ¤ G90', 'ì œë„¤ì‹œìŠ¤ GV70',
            'ë§ë¦¬ë¶€', 'íŠ¸ë˜ë²„ìŠ¤', 'ë‹ˆë¡œ', 'ìŠ¤íŒ…ì–´', 'ë²¨ë¡œìŠ¤í„°', 'ì½”ë‚˜'
        ];

        // ë‹¤ìŒ ì°¨ëŸ‰ ë²ˆí˜¸ ìƒì„±
        function getNextPlateNumber() {
            const plateNumber = `${currentCarNumber}ê°€${currentCarNumber}`;
            currentCarNumber++;
            return plateNumber;
        }

        // ëœë¤ ì°¨ëŸ‰ ëª¨ë¸ ì„ íƒ
        function getRandomCarModel() {
            const randomIndex = Math.floor(Math.random() * carModels.length);
            return carModels[randomIndex];
        }

        // ëœë¤ ì™„ë£Œ ì˜ˆì • ì‹œê°„ ìƒì„± (í˜„ì¬ ì‹œê°„ë¶€í„° 8ì‹œê°„ í›„ê¹Œì§€)
        function getRandomFinishTime() {
            const now = new Date();
            const minMinutes = 30; // ìµœì†Œ 30ë¶„ í›„
            const maxMinutes = 8 * 60; // ìµœëŒ€ 8ì‹œê°„ í›„
            
            const randomMinutes = Math.floor(Math.random() * (maxMinutes - minMinutes)) + minMinutes;
            const finishTime = new Date(now.getTime() + randomMinutes * 60000);
            
            // HH:MM í˜•ì‹ìœ¼ë¡œ ë°˜í™˜
            const hours = String(finishTime.getHours()).padStart(2, '0');
            const minutes = String(finishTime.getMinutes()).padStart(2, '0');
            return `${hours}:${minutes}`;
        }

        // ì°¨ëŸ‰ ë²ˆí˜¸ í•„ë“œ ì—…ë°ì´íŠ¸
        function updatePlateNumberField() {
            const nextPlateNumber = getNextPlateNumber();
            document.getElementById('addPlateNumber').value = nextPlateNumber;
            console.log('ì°¨ëŸ‰ ë²ˆí˜¸ ì—…ë°ì´íŠ¸:', nextPlateNumber);
        }

        // ì°¨ëŸ‰ ëª¨ë¸ í•„ë“œ ì—…ë°ì´íŠ¸
        function updateCarModelField() {
            document.getElementById('addCarModel').value = getRandomCarModel();
        }

        // ì™„ë£Œ ì˜ˆì • ì‹œê°„ í•„ë“œ ì—…ë°ì´íŠ¸
        function updateFinishTimeField() {
            const repairStatus = document.getElementById('addRepairStatus').value;
            if (repairStatus === 'COMPLETED') {
                document.getElementById('addFinishTime').value = '';
            } else {
                document.getElementById('addFinishTime').value = getRandomFinishTime();
            }
        }

        // IP ì„ íƒ ì²˜ë¦¬
        function handleIpSelection() {
            const selectElement = document.getElementById('serverIpSelect');
            const inputElement = document.getElementById('serverIp');
            
            if (selectElement.value === 'custom') {
                // ì§ì ‘ ì…ë ¥ ëª¨ë“œ
                selectElement.style.display = 'none';
                inputElement.style.display = 'block';
                inputElement.focus();
                inputElement.value = '';
            } else {
                // ë¯¸ë¦¬ ì •ì˜ëœ IP ì„ íƒ
                inputElement.value = selectElement.value;
            }
        }

        // IP ì…ë ¥ í•„ë“œ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
        function handleIpInputKeydown(event) {
            if (event.key === 'Escape') {
                // ESC í‚¤ë¥¼ ëˆ„ë¥´ë©´ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                const selectElement = document.getElementById('serverIpSelect');
                const inputElement = document.getElementById('serverIp');
                
                selectElement.style.display = 'block';
                inputElement.style.display = 'none';
                selectElement.value = '172.23.249.90'; // ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
                inputElement.value = '172.23.249.90';
                selectElement.focus();
            }
        }

        // ì„œë²„ URL êµ¬ì„±
        function getServerUrl() {
            const selectElement = document.getElementById('serverIpSelect');
            const inputElement = document.getElementById('serverIp');
            
            let ip;
            if (selectElement.style.display === 'none') {
                // ì§ì ‘ ì…ë ¥ ëª¨ë“œ
                ip = inputElement.value || '172.23.249.90';
            } else {
                // ë“œë¡­ë‹¤ìš´ ì„ íƒ ëª¨ë“œ
                ip = selectElement.value || '172.23.249.90';
            }
            
            const port = document.getElementById('serverPort').value || '8080';
            return `http://${ip}:${port}`;
        }

        // ì‘ë‹µ ë¡œê·¸ ì¶œë ¥
        function logResponse(method, url, response, isError = false) {
            const responseArea = document.getElementById('responseArea');
            const timestamp = new Date().toLocaleTimeString();
            const status = isError ? 'âŒ ERROR' : 'âœ… SUCCESS';
            
            const logEntry = `[${timestamp}] ${status} ${method} ${url}\n${JSON.stringify(response, null, 2)}\n\n`;
            responseArea.textContent = logEntry + responseArea.textContent;
        }

        // ì‘ë‹µ í™”ë©´ ì§€ìš°ê¸°
        function clearResponse() {
            document.getElementById('responseArea').textContent = 'ì—¬ê¸°ì— API ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤...';
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading(elementId, show = true) {
            const element = document.getElementById(elementId);
            element.style.display = show ? 'block' : 'none';
        }

        // ì¶”ê°€ ê²°ê³¼ í‘œì‹œ
        function showAddResult(message, isSuccess = true) {
            const resultArea = document.getElementById('addResultArea');
            const resultMessage = document.getElementById('addResultMessage');
            
            resultArea.style.display = 'block';
            resultArea.style.backgroundColor = isSuccess ? '#d4edda' : '#f8d7da';
            resultArea.style.borderColor = isSuccess ? '#c3e6cb' : '#f5c6cb';
            resultArea.style.color = isSuccess ? '#155724' : '#721c24';
            resultArea.style.border = `1px solid ${isSuccess ? '#c3e6cb' : '#f5c6cb'}`;
            
            resultMessage.textContent = message;
            
            // 3ì´ˆ í›„ ìë™ìœ¼ë¡œ ìˆ¨ê¸°ê¸°
            setTimeout(() => {
                resultArea.style.display = 'none';
            }, 3000);
        }

        // ì „ì²´ ì°¨ëŸ‰ ëª©ë¡ ì¡°íšŒ
        async function getAllCarRepairInfo() {
            showLoading('loadingAll', true);
            try {
                const response = await fetch(`${getServerUrl()}/api/car-repair`);
                const data = await response.json();
                
                logResponse('GET', '/api/car-repair', data);
                
                if (data.success && data.data) {
                    displayCarList(data.data);
                } else {
                    displayCarList([]);
                }
            } catch (error) {
                logResponse('GET', '/api/car-repair', { error: error.message }, true);
                displayCarList([]);
            } finally {
                showLoading('loadingAll', false);
            }
        }

        // ì°¨ëŸ‰ ëª©ë¡ í™”ë©´ì— í‘œì‹œ
        function displayCarList(cars) {
            const carList = document.getElementById('carList');
            
            if (!cars || cars.length === 0) {
                carList.innerHTML = '<p style="text-align: center; color: #6c757d; grid-column: 1/-1;">ë“±ë¡ëœ ì°¨ëŸ‰ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            carList.innerHTML = cars.map(car => `
                <div class="car-item">
                    <h3>${car.licensePlateNumber}</h3>
                    <p><strong>ëª¨ë¸:</strong> ${car.carModel}</p>
                    <p><strong>ìƒíƒœ:</strong> <span class="car-status status-${car.repairStatus.toLowerCase().replace('_', '-')}">${getStatusText(car.repairStatus)}</span></p>
                    ${car.repairStatus !== 'COMPLETED' ? `<p><strong>ì™„ë£Œ ì˜ˆì •:</strong> ${car.estimatedFinishTime || 'ë¯¸ì •'}</p>` : ''}
                    <div style="margin-top: 15px;">
                        <button class="btn btn-info" style="font-size: 12px; padding: 5px 10px;" onclick="fillUpdateForm('${car.licensePlateNumber}', '${car.carModel}', '${car.repairStatus}', '${car.estimatedFinishTime || ''}')">ìˆ˜ì •</button>
                        <button class="btn btn-danger" style="font-size: 12px; padding: 5px 10px;" onclick="quickDelete('${car.licensePlateNumber}')">ì‚­ì œ</button>
                    </div>
                </div>
            `).join('');
        }

        // ìƒíƒœ í…ìŠ¤íŠ¸ ë³€í™˜
        function getStatusText(status) {
            const statusMap = {
                'IN_PROGRESS': 'ì‘ì—…ì¤‘',
                'FINAL_INSPECTION': 'ìµœì¢…ì ê²€',
                'COMPLETED': 'ì‘ì—…ì™„ë£Œ'
            };
            return statusMap[status] || status;
        }

        // ìˆ˜ì • í¼ ìë™ ì±„ìš°ê¸°
        function fillUpdateForm(plateNumber, carModel, repairStatus, finishTime) {
            document.getElementById('updatePlateNumber').value = plateNumber;
            document.getElementById('updateCarModel').value = carModel;
            document.getElementById('updateRepairStatus').value = repairStatus;
            document.getElementById('updateFinishTime').value = finishTime;
            
            // ìˆ˜ì • ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.querySelector('h2:nth-of-type(4)').scrollIntoView({ behavior: 'smooth' });
        }

        // ë¹ ë¥¸ ì‚­ì œ
        async function quickDelete(plateNumber) {
            if (confirm(`ì •ë§ë¡œ ì°¨ëŸ‰ "${plateNumber}"ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                document.getElementById('deletePlateNumber').value = plateNumber;
                await deleteCarRepairInfo();
                await getAllCarRepairInfo(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            }
        }

        // ìƒˆ ì°¨ëŸ‰ ì •ë³´ ì¶”ê°€
        async function addCarRepairInfo() {
            const plateNumber = document.getElementById('addPlateNumber').value;
            const carModel = document.getElementById('addCarModel').value;
            const repairStatus = document.getElementById('addRepairStatus').value;
            const finishTime = document.getElementById('addFinishTime').value;

            if (!plateNumber || !carModel) {
                alert('ì°¨ëŸ‰ ë²ˆí˜¸ì™€ ëª¨ë¸ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.');
                return;
            }

            const data = {
                licensePlateNumber: plateNumber,
                carModel: carModel,
                repairStatus: repairStatus,
                estimatedFinishTime: repairStatus === 'COMPLETED' ? null : finishTime
            };

            try {
                const response = await fetch(`${getServerUrl()}/api/car-repair`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                
                logResponse('POST', '/api/car-repair', result);
                
                // ì‘ë‹µ ì„±ê³µ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ë‹¤ìŒ ì°¨ëŸ‰ì„ ìœ„í•´ í•„ë“œ ì—…ë°ì´íŠ¸
                updatePlateNumberField();
                updateCarModelField();
                updateFinishTimeField();
                
                if (result.success || response.ok) {
                    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                    showAddResult(`âœ… ì°¨ëŸ‰ "${plateNumber}" ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`, true);
                    
                    // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    getAllCarRepairInfo();
                } else {
                    // ì‹¤íŒ¨ ë©”ì‹œì§€ í‘œì‹œ
                    showAddResult(`âŒ ì°¨ëŸ‰ ì •ë³´ ì¶”ê°€ ì‹¤íŒ¨: ${result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`, false);
                }
            } catch (error) {
                logResponse('POST', '/api/car-repair', { error: error.message }, true);
                
                // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
                showAddResult(`âŒ ì„œë²„ ì—°ê²° ì˜¤ë¥˜: ${error.message}`, false);
                
                // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ ë‹¤ìŒ ì°¨ëŸ‰ì„ ìœ„í•´ í•„ë“œ ì—…ë°ì´íŠ¸
                updatePlateNumberField();
                updateCarModelField();
                updateFinishTimeField();
            }
        }

        // íŠ¹ì • ì°¨ëŸ‰ ì¡°íšŒ
        async function getCarRepairInfo() {
            const plateNumber = document.getElementById('searchPlateNumber').value;
            
            if (!plateNumber) {
                alert('ì°¨ëŸ‰ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch(`${getServerUrl()}/api/car-repair/${encodeURIComponent(plateNumber)}`);
                const data = await response.json();
                
                logResponse('GET', `/api/car-repair/${plateNumber}`, data);
            } catch (error) {
                logResponse('GET', `/api/car-repair/${plateNumber}`, { error: error.message }, true);
            }
        }

        // ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì •
        async function updateCarRepairInfo() {
            const plateNumber = document.getElementById('updatePlateNumber').value;
            const carModel = document.getElementById('updateCarModel').value;
            const repairStatus = document.getElementById('updateRepairStatus').value;
            const finishTime = document.getElementById('updateFinishTime').value;

            if (!plateNumber) {
                alert('ì°¨ëŸ‰ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            const data = {
                carModel: carModel,
                repairStatus: repairStatus,
                estimatedFinishTime: repairStatus === 'COMPLETED' ? null : finishTime
            };

            try {
                const response = await fetch(`${getServerUrl()}/api/car-repair/${encodeURIComponent(plateNumber)}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                
                logResponse('PUT', `/api/car-repair/${plateNumber}`, result);
                
                if (result.success) {
                    // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    getAllCarRepairInfo();
                }
            } catch (error) {
                logResponse('PUT', `/api/car-repair/${plateNumber}`, { error: error.message }, true);
            }
        }

        // ì°¨ëŸ‰ ì •ë³´ ì‚­ì œ
        async function deleteCarRepairInfo() {
            const plateNumber = document.getElementById('deletePlateNumber').value;
            
            if (!plateNumber) {
                alert('ì°¨ëŸ‰ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch(`${getServerUrl()}/api/car-repair/${encodeURIComponent(plateNumber)}`, {
                    method: 'DELETE'
                });
                const data = await response.json();
                
                logResponse('DELETE', `/api/car-repair/${plateNumber}`, data);
                
                if (data.success) {
                    document.getElementById('deletePlateNumber').value = '';
                    // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    getAllCarRepairInfo();
                }
            } catch (error) {
                logResponse('DELETE', `/api/car-repair/${plateNumber}`, { error: error.message }, true);
            }
        }

        // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¶”ê°€ (http-server.shì™€ ë™ì¼)
        async function addTestData() {
            const testCars = [
                {
                    licensePlateNumber: "0012íŒŒ0012",
                    carModel: "ì†Œë‚˜íƒ€",
                    repairStatus: "IN_PROGRESS",
                    estimatedFinishTime: "14:30:00"
                },
                {
                    licensePlateNumber: "0015íƒ€0015",
                    carModel: "X5",
                    repairStatus: "IN_PROGRESS",
                    estimatedFinishTime: "18:30:00"
                },
                {
                    licensePlateNumber: "0016í•˜0016",
                    carModel: "ë¥´ë§",
                    repairStatus: "FINAL_INSPECTION",
                    estimatedFinishTime: "18:00:00"
                },
                {
                    licensePlateNumber: "0017ë³´0017",
                    carModel: "E500",
                    repairStatus: "FINAL_INSPECTION",
                    estimatedFinishTime: "17:00:00"
                }
            ];

            for (const car of testCars) {
                try {
                    const response = await fetch(`${getServerUrl()}/api/car-repair`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(car)
                    });
                    const result = await response.json();
                    logResponse('POST', '/api/car-repair', result);
                    
                    // ê° ìš”ì²­ ì‚¬ì´ì— ì ì‹œ ëŒ€ê¸°
                    await new Promise(resolve => setTimeout(resolve, 100));
                } catch (error) {
                    logResponse('POST', '/api/car-repair', { error: error.message }, true);
                }
            }
            
            // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            getAllCarRepairInfo();
        }

        // í…ŒìŠ¤íŠ¸ ì¡°íšŒ
        async function testQueries() {
            const testPlates = ["004ë¼444", "007ì‚¬777"];
            
            for (const plate of testPlates) {
                try {
                    const response = await fetch(`${getServerUrl()}/api/car-repair/${encodeURIComponent(plate)}`);
                    const data = await response.json();
                    logResponse('GET', `/api/car-repair/${plate}`, data);
                    
                    await new Promise(resolve => setTimeout(resolve, 100));
                } catch (error) {
                    logResponse('GET', `/api/car-repair/${plate}`, { error: error.message }, true);
                }
            }
        }

        // í…ŒìŠ¤íŠ¸ ìˆ˜ì •
        async function testUpdates() {
            const updates = [
                {
                    plate: "0012íŒŒ0012",
                    data: {
                        carModel: "ì†Œë‚˜íƒ€",
                        repairStatus: "COMPLETED",
                        estimatedFinishTime: null
                    }
                },
                {
                    plate: "0010ì°¨100",
                    data: {
                        carModel: "ì†Œë‚˜íƒ€",
                        repairStatus: "IN_PROGRESS",
                        estimatedFinishTime: "16:15:00"
                    }
                }
            ];

            for (const update of updates) {
                try {
                    const response = await fetch(`${getServerUrl()}/api/car-repair/${encodeURIComponent(update.plate)}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(update.data)
                    });
                    const result = await response.json();
                    logResponse('PUT', `/api/car-repair/${update.plate}`, result);
                    
                    await new Promise(resolve => setTimeout(resolve, 100));
                } catch (error) {
                    logResponse('PUT', `/api/car-repair/${update.plate}`, { error: error.message }, true);
                }
            }
            
            // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            getAllCarRepairInfo();
        }

        // í…ŒìŠ¤íŠ¸ ì‚­ì œ
        async function testDeletes() {
            const testPlates = ["005ë§ˆ555", "003ë‹¤333", "002ë‚˜222"];
            
            for (const plate of testPlates) {
                try {
                    const response = await fetch(`${getServerUrl()}/api/car-repair/${encodeURIComponent(plate)}`, {
                        method: 'DELETE'
                    });
                    const data = await response.json();
                    logResponse('DELETE', `/api/car-repair/${plate}`, data);
                    
                    await new Promise(resolve => setTimeout(resolve, 100));
                } catch (error) {
                    logResponse('DELETE', `/api/car-repair/${plate}`, { error: error.message }, true);
                }
            }
            
            // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            getAllCarRepairInfo();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì „ì²´ ëª©ë¡ ì¡°íšŒ ë° ì´ˆê¸° ì„¤ì •
        window.addEventListener('load', function() {
            getAllCarRepairInfo();
            // ì´ˆê¸° í•„ë“œ ì„¤ì • (ì°¨ëŸ‰ ë²ˆí˜¸ëŠ” 100ê°€100ë¶€í„° ì‹œì‘)
            document.getElementById('addPlateNumber').value = '100ê°€100';
            updateCarModelField();
            updateFinishTimeField();
        });
    </script>
</body>
</html>
